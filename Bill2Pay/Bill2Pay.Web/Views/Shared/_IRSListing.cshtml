@model IEnumerable<Bill2Pay.Model.MerchantListVM>
@*<link href="~/Content/w3.css" rel="stylesheet" />*@
<script>
    
    function SetSelecAllMerchant()
    {
        $('.tblchk').prop('checked', $('#chkSelectAll').is(":checked"));

        var strAcnos = $('#checkedAccountNo').val();

        var acno = JSON.parse(strAcnos);

        for (var i = 0; i < acno.length; i++) {

            if ($('#chkSelectAll').is(":checked")) {
                    acno[i].IsChecked = '1';
                }
                else {
                    acno[i].IsChecked = '0';
                }
        }

        strAcnos = JSON.stringify(acno);
        $('#checkedAccountNo').val(strAcnos);
    }


    function GetSelectedMerchant(accno) {
        
        var strAcnos = $('#checkedAccountNo').val();
       
        var acno=JSON.parse(strAcnos);
        
        for(var i=0;i<acno.length;i++)
        {

         
            if(acno[i].AccountNo==accno)
            {
                if(acno[i].IsChecked=='0')
                {
                    acno[i].IsChecked='1';
                }
                else
                {
                    acno[i].IsChecked='0';
                }
            }
        }

        strAcnos=JSON.stringify(acno);

        $('#checkedAccountNo').val(strAcnos);
  

    }

    function submitForm(statusId)
    {
        var form = $('#IRSListing');
        
        $('#statusId').val(statusId);
        form.submit();
    }
</script>



<div class="row">
    @using (Html.BeginForm("Process", "IRSProcess", new { ReturnUrl = ViewBag.ReturnUrl }, FormMethod.Post, new { @class = "form-horizontal", role = "form", Id = "IRSListing" }))
    {
        @Html.AntiForgeryToken()

        @Html.Hidden("checkedAccountNo", (object)@ViewBag.lstmerchantAcc)
        @Html.Hidden("statusId", "");
        @Html.Partial("_SelectYear", new Bill2Pay.Web.YearSelection() { AllowPostback = true })

        <div class="col-md-12">
           

            @{
                if (Request.IsAuthenticated && User.IsInRole("Admin"))
                {


                    <button class="btn  btn-primary" type="submit" name="tinmatching" value="TIN Matching Input">TIN Matching Input</button>
                                <button class="btn  btn-primary" type="submit" name="irstest" value="IRS FIRE Test Input">IRS FIRE Test Input</button>
                                <button class="btn  btn-primary" type="submit" name="irs" value="IRS FIRE Input">IRS FIRE Input </button>
                                <button class="btn  btn-primary disabled" disabled="disabled" type="submit" name="irscorrection" value="IRS FIRE Correction Input">IRS FIRE Correction Input</button>
                                <div class="dropdown" style="float:right">
                                    <button class="btn btn-success dropdown-toggle" type="submit" data-toggle="dropdown">
                                        Change Status
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a href="#" onclick="submitForm(1);">Not Submitted</a></li>
                                        <li><a href="#" onclick="submitForm(6);">Submitted</a></li>
                                        @*<li><a href="#" onclick="submitForm(3);">Correction Required</a></li>*@
                                    </ul>
                                </div>


                }

            }
            <hr />
        </div>
            <div class="col-md-12">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th class="btn-primary"><input id="chkSelectAll"  onclick="SetSelecAllMerchant();" title="Select All" type="checkbox" /></th>
                                <th class="btn-primary">1099-K Copies</th>
                                <th class="btn-primary">Account Number</th>
                                <th class="btn-primary">TIN</th>
                                <th class="btn-primary">Merchant Name</th>
                                <th class="btn-primary">Address</th>
                                <th class="btn-primary">MCC</th>
                                <th class="btn-primary">TIN Status</th>
                                <th class="btn-primary">IRS Status</th>

                            </tr>
                        </thead>
                        <tbody>
                            @{

                                if (Model != null)
                                {
                                    if (Model.Count() == 0)
                                    {
                                        <tr>
                                            <td> </td>
                                            <td style="width:100px" align="center"> </td>
                                            <td> </td>
                                            <td> </td>
                                            <td><span>No data found </span></td>
                                            <td> </td>
                                            <td> </td>
                                            <td> </td>
                                            <td> </td>
                                        </tr>

                                    }
                                    else
                                    {
                                        foreach (var item in Model)
                                        {
                                        <tr>
                                            <td>
                                                <input id="chkAccountNo" class="tblchk" onclick="GetSelectedMerchant('@item.ImportDetails.AccountNo');" type="checkbox" />&nbsp;
                                            </td>
                                            <td style="width:100px" align="center" >
                                               
                                                <a href="@Url.Action("Details", new { Id = item.ImportDetails.AccountNo })" alt="1099K" >
                                                    <i class="fa fa-files-o fa-lg" title="Generate 1099-K Copies" alt="1099K" ></i>
                                                </a>


                                            </td>
                                            <td>@item.ImportDetails.AccountNo</td>
                                            <td>@item.ImportDetails.TIN </td>
                                            <td>@item.ImportDetails.FirstPayeeName  </td>
                                            <td>@item.ImportDetails.PayeeMailingAddress </td>
                                            <td>@item.ImportDetails.MerchantCategoryCode</td>
                                            <td align="center" >
                                                @{
                                                    if (!string.IsNullOrEmpty(@item.ImportDetails.TINCheckStatus))
                                                    {
                                                        if (@item.ImportDetails.TINCheckStatus.Equals("0", StringComparison.InvariantCultureIgnoreCase)
                                                                        || @item.ImportDetails.TINCheckStatus.Equals("6", StringComparison.InvariantCultureIgnoreCase)
                                                                        || @item.ImportDetails.TINCheckStatus.Equals("7", StringComparison.InvariantCultureIgnoreCase)
                                                                        || @item.ImportDetails.TINCheckStatus.Equals("8", StringComparison.InvariantCultureIgnoreCase))
                                                        {
                                                            <img style="width:25px; height:25px" title='TIN match sucessfull' src="@Url.Content("~/Images/true.png")" />
                                                        }
                                                        else
                                                        {

                                                            <img style="width:25px; height:25px" title='@item.ImportDetails.TINCheckRemarks' src="@Url.Content("~/Images/false.png")" />

                                                        }
                                                    }

                                                }


                                            </td>
                                            <td align="center">
                                                @{

                                                    if (@item.SubmissionStatus != null)
                                                    {

                                                        if (@item.SubmissionStatus.StatusId == 2)
                                                        {
                                                            <img style="width:30px; height:30px" title='@item.SubmissionStatus.Status.Name' src="@Url.Content("~/Images/Generated.png")" />
                                                        }
                                                        else if (@item.SubmissionStatus.StatusId == 3)
                                                        {
                                                            <img style="width:25px; height:25px" title='@item.SubmissionStatus.Status.Name' src="@Url.Content("~/Images/CorrectionRequired.png")" />
                                                        }
                                                        else if (@item.SubmissionStatus.StatusId == 4)
                                                        {
                                                            <img style="width:25px; height:25px" title='@item.SubmissionStatus.Status.Name' src="@Url.Content("~/Images/CorrectionUpload.jpg")" />
                                                        }
                                                        else if (@item.SubmissionStatus.StatusId == 5)
                                                        {
                                                            <img style="width:25px; height:25px" title='@item.SubmissionStatus.Status.Name' src="@Url.Content("~/Images/resubmitted.png")" />
                                                        }
                                                        else if (@item.SubmissionStatus.StatusId == 6)
                                                        {
                                                            <img style="width:25px; height:25px" title='@item.SubmissionStatus.Status.Name' src="@Url.Content("~/Images/submitted.png")" />
                                                        }
                                                    }
                                                }
                                            </td>

                                        </tr>
                                        }
                                    }
                                }
                             }
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="col-md-12">
                <hr />

                @{
                    if (Request.IsAuthenticated && User.IsInRole("Admin"))
                    {
                                <button class="btn  btn-primary" type="submit" name="tinmatching" value="TIN Matching Input">TIN Matching Input</button>
                                <button class="btn  btn-primary" type="submit" name="irstest" value="IRS FIRE Test Input">IRS FIRE Test Input</button>
                                <button class="btn  btn-primary" type="submit" name="irs" value="IRS FIRE Input">IRS FIRE Input </button>
                                <button class="btn  btn-primary disabled" disabled="disabled" type="submit" name="irscorrection" value="IRS FIRE Correction Input">IRS FIRE Correction Input</button>
                                <div class="dropup" style="float:right">
                                    <button class="btn btn-success dropdown-toggle" type="submit" data-toggle="dropdown">
                                        Change Status
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a href="#" onclick="submitForm(1);">Not Submitted</a></li>
                                        <li><a href="#" onclick="submitForm(6);">Submitted</a></li>
                                        @*<li><a href="#" onclick="submitForm(3);">Correction Required</a></li>*@
                                    </ul>
                                </div>
                    }

                }
            </div>
                    }
</div>

<style>
    input[type="checkbox"] {
        height: 18px;
        width: 18px;
    }
</style>